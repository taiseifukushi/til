# "2022-02-12"

## やること

## 疑問点

## メモ

---

# RSpec
## 曖昧な点
- let, let!, before の使いどき
- スタブ化, モック化
    - `allow recieve return`
    - spec/support とか別ファイルで、メソッド作って活用する方法
## まとめたい
- `Timecop`
    - https://github.com/travisjeffery/timecop
    - 時間に関するテストを書くとき、時間を固定するライブラリ

# prettier設定
~/Library/Application Support/Code/User/settings.json
https://prettier.io/docs/en/api.html
あとで

# ruby 非同期処理のあれこれ
参考：
- https://gist.github.com/hoco/9764412
- https://hellooooooo.hatenablog.com/entry/2019/12/24/090043

## やること
rubyの非同期処理についてまとめる

## メモ
### キーワード
- 並行処理
- 並列処理
- Activejob
- Delayedjob

### Active Jobとは？
>Active Jobは、**ジョブを宣言し、それによってバックエンドでさまざまな方法によるキュー操作を実行するためのフレームワーク**
https://railsguides.jp/active_job_basics.html#active-job%E3%81%AE%E7%9B%AE%E7%9A%84

>Active Jobの主要な目的は、あらゆるRailsアプリケーションにジョブ管理インフラを配置することです。これにより、Delayed JobとResqueなどのように、さまざまなジョブ実行機能のAPIの違いを気にせずにジョブフレームワーク機能やその他のgemを搭載することができるようになります。バックエンドでのキューイング作業では、操作方法以外のことを気にせずに済みます。さらに、ジョブ管理フレームワークを切り替える際にジョブを書き直さずに済みます。

#### Job（ジョブ）とQueue（キュー）
その前に、Job（ジョブ）とQueue（キュー）とは？
参考：
https://qiita.com/petertakahashi/items/cb9ae73e5ba3020f4a89#job%E3%82%B8%E3%83%A7%E3%83%96%E3%81%A8queue%E3%82%AD%E3%83%A5%E3%83%BC

Job	ジョブ	コンピュータがする仕事の単位
= タスク?
**プロセス**というワードもあった気がする

Queue	キュー	データ構造の一つ。待ち行列ともいう
イメージは**タスクを登録するための入れ物**
>**先入れ先出し（First In First Out : FIFO）型の記憶装置**

補足：
似ている概念で**スタック**がある
>後入れ先出し（Last In First Out : LIFO）型の記憶装置

>ActiveJobはこれらの処理をバックグラウンドで実行することができる機能のことをいいます。
とのこと

#### 非同期処理を実現するために必要なライブラリが、`Delayed Job`等のgem
>ActiveJobには非同期バックエンドなるサードパーティーのキューイングライブラリが必要です。

どうしてか？
>ActiveJobには非同期バックエンドなるサードパーティーのキューイングライブラリが必要です。
>開発環境や、小規模アプリケーションの場合には、ActiveJobのみでも問題ないのですが、本番環境でアプリケーションを運用していくとなると、いろいろと不都合がでてきます。
>Railsから提供されているActiveJobには、ジョブをメモリに保持するインプロセスのキューイングシステムだけなので、プロセスが切れたりするとジョブは全て失われます。
https://qiita.com/petertakahashi/items/cb9ae73e5ba3020f4a89#%E3%81%AA%E3%81%9C%E9%9D%9E%E5%90%8C%E6%9C%9F%E3%83%90%E3%83%83%E3%82%AF%E3%82%A8%E3%83%B3%E3%83%89%E3%81%8C%E5%BF%85%E8%A6%81%E3%81%AA%E3%81%AE%E3%81%8B

**`Railsから提供されているActiveJobには、ジョブをメモリに保持するインプロセスのキューイングシステムだけなので、プロセスが切れたりするとジョブは全て失われます。`**
これよくわからん

インプロセス = 進行中
キューイングシステム

プロセスってなんだ？

`ジョブ`と`プロセス`の違いは？
と`プロセス`の関係

##### ジョブとは
##### タスクとは
タスクとは、コンピューターが「実行中のプログラム」です。と識別する仕事の単位
##### プロセスとは

プロセス
プログラムの実行単位。
プロセスは1つ以上のスレッドと、ファイル、ヒープメモリなどのリソースで構成される。
カーネルによってプロセスIDは管理される

スレッド
CPU 利用の単位。
スレッドはそれぞれが専用のスタックと CPU レジスタのコピーを保持する。
一方でファイルやヒープメモリは同一プロセス内の全てのスレッドで共有する。
スレッドのさらにサブセットがファイバ。

タスク
タスクという言葉は曖昧

ジョブ

ジョブ
人間からみた仕事の単位

タスク
コンピューターからみた仕事の単位

```md
1. バッチ処理の場合
ユーザがジョブを作成する。
(ジョブ制御言語で記述して、コンピューターに支持を与える)
2. ジョブ管理がこれを受け取り、「**ジョブステップ**」という単位に分解する
3. 「**タスク管理**」がジョブステップごとに、**タスク**を作成する。これによってコンピューターが実行できるようになる
4. 
参考：
http://www.mij-s.com/pafu/web_fe/gozen/02/2_7.htm#:~:text=%E3%82%B8%E3%83%A7%E3%83%96%E3%81%A8%E3%82%BF%E3%82%B9%E3%82%AF%20%E3%80%8C%E3%82%B8%E3%83%A7%E3%83%96%E3%80%8D%E3%81%A8,%E3%82%8B%E5%86%85%E9%83%A8%E5%87%A6%E7%90%86%E3%81%AE%E5%8D%98%E4%BD%8D)%E3%80%82&text=%E3%82%B8%E3%83%A7%E3%83%96%E7%AE%A1%E7%90%86%E3%81%8C%E3%81%93%E3%82%8C%E3%82%92,%E5%8D%98%E4%BD%8D%E3%81%AB%E5%88%86%E5%89%B2%E3%81%97%E3%81%BE%E3%81%99%E3%80%82
```



