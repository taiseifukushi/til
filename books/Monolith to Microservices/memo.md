# Monolith to Microservices

## マイクロサービス と モノリス

マイクロサービス
- ビジネスドメインに基づいてモデル化された、独立してデプロイ可能なサービス
- サービス同士はネットワークを介して相互に通信してシステムを形成する
  - カプセル化されたビジネス機能を1つ以上のネットワークエンドポイントを介して公開する
  - ネットワークを介して相互に通信しあい、分散システムを形成する

### 独立デプロイ可能性

あるマイクロサービスに対する変更を他のサービスに影響を与えることなく、本番環境へデプロイできる
-> サービス同士が疎結合である必要がある

3層アーキテクチャ
プレゼンテーション層、ファンクション層、データ層

機能の変更が生じる場合、ビジネス機能が実質的に3層全てに分散しているため、
その機能変更が、層をまたいで行われる可能性が高くなる。

### マイクロサービスはデータベースを共有すべきでないという考え方がある

あるサービスが他のサービスの保持するデータにアクセスしたい場合には、必要なデータをそのサービスに要求しなければならない
-> サービスは何を共有して何を隠すかを決める必要がある


### マイクロサービスの問題

サービス間の通信は、レイテンシーの影響を受ける
-> 単一プロセスのモノリスでは比較的単純に行えるトランザクションのような処理を困難にする

ネットワーク呼び出しに常に失敗する可能性がある

### ユーザーインターフェイスの分解


### マイクロサービスにおけるサイズ

マイクロサービスの目標は「可能な限り小さなインターフェイス」を持つこと
-> 情報隠蔽の考え方

---

### モノリス

#### 単一プロセスのモノリス

単一のプロセスとしてデプロイされているシステム
-> これらの単一プロセスのシステムは、ほとんど常にデータベースからデータを読み込んだり、データベースにデータを保存したりするため、それ自体が単純な分散システムになる

#### モジュラーモノリス

単一プロセスが別々のモジュールで構成される。
それぞれ独立して、作業ができるが、デプロイのために結合する必要がある。

コードレベルでは分解できるが、データベースは分解されていないことが課題

### モノリスの課題

実装、デプロイ時の結合に対して、マイクロサービスより脆弱である

同じ場所で作業する人が増えれば増えるほど、作業が衝突する。

### モノリスの利点

マイクロサービスと比較して、
デプロイ、監視、トラブルシューティング、テストなどの作業がずっとシンプル


---

## 結合と凝集

>構造は、凝集度が高く、結合度が低い場合に安定する。

結合
-> あるものに対する変更がどれくらい別のものの変更を必要とするか

凝集
-> 関連するコードをどのようにグループ化するか

### 凝集が好ましい一方で、結合には注意が必要

結合すればするほど、一緒に変更しなければならないものがあるため

---

## 接合部（seam）

接合部（seam）とは、既存の振る舞いを変更せずにプログラムの振る舞いを変えられる場所

